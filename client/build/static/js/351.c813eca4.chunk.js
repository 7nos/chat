"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[351],{351:(e,t,s)=>{s.r(t),s.d(t,{default:()=>i});var o=s(43),r=s(216),a=s(505),n=s(579);const i=e=>{let{setIsAuthenticated:t}=e;const[s,i]=(0,o.useState)(!0),[c,l]=(0,o.useState)(""),[d,u]=(0,o.useState)(""),[p,m]=(0,o.useState)(""),[h,g]=(0,o.useState)(!1),I=(0,r.Zp)();return(0,n.jsx)("div",{className:"auth-container",children:(0,n.jsxs)("div",{className:"auth-box",children:[(0,n.jsx)("h2",{children:s?"Sign In":"Sign Up"}),(0,n.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),m(""),g(!0),!c.trim()||!d.trim())return m("Username and password cannot be empty."),void g(!1);try{let e;const o={username:c,password:d};if(s)e=await(0,a.kv)(o);else{if(d.length<6)return m("Password must be at least 6 characters long."),void g(!1);e=await(0,a.E_)(o)}const{sessionId:r,username:n,_id:i}=e.data;if(!i||!r||!n)throw new Error("Incomplete authentication data received from server.");localStorage.setItem("sessionId",r),localStorage.setItem("username",n),localStorage.setItem("userId",i),t(!0),I("/chat",{replace:!0})}catch(n){var o,r;const e=(null===(o=n.response)||void 0===o||null===(r=o.data)||void 0===r?void 0:r.message)||n.message||"An error occurred during ".concat(s?"sign in":"sign up",".");m(e),console.error("Auth Error:",n.response||n),localStorage.removeItem("sessionId"),localStorage.removeItem("username"),localStorage.removeItem("userId"),t(!1)}finally{g(!1)}},children:[(0,n.jsxs)("div",{className:"input-group",children:[(0,n.jsx)("label",{htmlFor:"username",children:"Username"}),(0,n.jsx)("input",{type:"text",id:"username",value:c,onChange:e=>l(e.target.value),required:!0,autoComplete:"username",disabled:h})]}),(0,n.jsxs)("div",{className:"input-group",children:[(0,n.jsx)("label",{htmlFor:"password",children:"Password"}),(0,n.jsx)("input",{type:"password",id:"password",value:d,onChange:e=>u(e.target.value),required:!0,autoComplete:s?"current-password":"new-password",disabled:h})]}),p&&(0,n.jsx)("p",{className:"error-message",children:p}),(0,n.jsx)("button",{type:"submit",disabled:h,className:"auth-button",children:h?"Processing...":s?"Sign In":"Sign Up"})]}),(0,n.jsx)("button",{onClick:()=>{i(!s),l(""),u(""),m("")},className:"toggle-button",disabled:h,children:s?"Need an account? Sign Up":"Have an account? Sign In"})]})})}},505:(e,t,s)=>{s.d(t,{DA:()=>m,E_:()=>n,Mk:()=>h,OW:()=>d,Pt:()=>u,QM:()=>p,_z:()=>c,al:()=>I,bW:()=>g,kv:()=>i,qR:()=>l});var o=s(722);const r=(()=>{const e={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_BACKEND_PORT||5001,t=window.location.hostname,s="https:"===window.location.protocol?"https:":"http:",o="localhost"===t||"127.0.0.1"===t?"localhost":t;return"".concat(s,"//").concat(o,":").concat(e,"/api")})();console.log("API Base URL:",r);const a=o.A.create({baseURL:r});a.interceptors.request.use((e=>{const t=localStorage.getItem("userId");if(t)e.headers["x-user-id"]=t;else if(!e.url.includes("/auth/"))return console.warn("API Interceptor: userId not found in localStorage for non-auth request to",e.url),window.location.href="/login?sessionExpired=true",Promise.reject(new Error("User ID not found. Please log in."));return e.data instanceof FormData?delete e.headers["Content-Type"]:e.headers["Content-Type"]||(e.headers["Content-Type"]="application/json"),e}),(e=>(console.error("API Request Interceptor Error:",e),Promise.reject(e)))),a.interceptors.response.use((e=>e),(e=>(e.response&&401===e.response.status&&(console.warn("API Response Interceptor: Received 401 Unauthorized. Clearing auth data and redirecting to login."),localStorage.removeItem("sessionId"),localStorage.removeItem("username"),localStorage.removeItem("userId"),window.location.pathname.includes("/login")||(window.location.href="/login?sessionExpired=true")),Promise.reject(e))));const n=e=>a.post("/auth/signup",e),i=e=>a.post("/auth/signin",e),c=async(e,t,s,a)=>{try{return(await o.A.post("".concat(r,"/api/chat/send"),{message:e,sessionId:t,messageHistory:s,llmPreference:a})).data}catch(n){throw console.error("Error sending message:",n),n}},l=e=>a.post("/chat/history",e),d=()=>a.get("/chat/sessions"),u=e=>a.get("/chat/session/".concat(e)),p=e=>a.post("/upload",e),m=()=>a.get("/files"),h=(e,t)=>a.patch("/files/".concat(e),{newOriginalName:t}),g=e=>a.delete("/files/".concat(e)),I=e=>a.post("/api/user/preferences/llm",{preference:e})}}]);
//# sourceMappingURL=351.c813eca4.chunk.js.map